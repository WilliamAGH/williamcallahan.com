npm run test

> william-callahan-dot-com@0.0.2 test
> jest --coverage

 PASS  __tests__/lib/setup/jest.setup.ts
 PASS  __tests__/lib/setup/logo.ts
 PASS  __tests__/lib/server-cache.test.ts
 PASS  __tests__/lib/blog.test.ts
 PASS  __tests__/lib/imageCompare.test.ts
  ● Console

    console.warn
      Image validation failed: Invalid format: invalid. Must be one of: jpeg, png, webp, gif, svg, ico

      223 |     if (!meta1.isValid || !meta2.isValid) {
      224 |       const error = meta1.validationError || meta2.validationError;
    > 225 |       console.warn("Image validation failed:", error);
          |               ^
      226 |       return false;
      227 |     }
      228 |

      at warn (lib/imageCompare.ts:225:15)
      at Object.<anonymous> (__tests__/lib/imageCompare.test.ts:88:22)

    console.warn
      Image validation failed: Image too small: 63x63. Minimum size: 64x64

      223 |     if (!meta1.isValid || !meta2.isValid) {
      224 |       const error = meta1.validationError || meta2.validationError;
    > 225 |       console.warn("Image validation failed:", error);
          |               ^
      226 |       return false;
      227 |     }
      228 |

      at warn (lib/imageCompare.ts:225:15)
      at Object.<anonymous> (__tests__/lib/imageCompare.test.ts:95:22)

    console.warn
      Size difference too large: 22px (max: 10px)

      231 |                     Math.abs(meta1.height - meta2.height);
      232 |     if (sizeDiff > CONFIG.MAX_SIZE_DIFF) {
    > 233 |       console.warn(
          |               ^
      234 |         `Size difference too large: ${sizeDiff}px (max: ${CONFIG.MAX_SIZE_DIFF}px)`
      235 |       );
      236 |       return false;

      at warn (lib/imageCompare.ts:233:15)
      at Object.<anonymous> (__tests__/lib/imageCompare.test.ts:102:22)

 PASS  __tests__/lib/utils.test.ts
 PASS  __tests__/lib/seo.test.ts
 PASS  __tests__/lib/imageAnalysis.test.ts
 PASS  __tests__/lib/search.test.ts
 FAIL  __tests__/lib/logo.test.ts
  ● Logo API › should handle successful logo fetches from Google

    expect(received).toBe(expected) // Object.is equality

    Expected: 200
    Received: 404

      120 |     const response = await GET(request);
      121 |
    > 122 |     expect(response.status).toBe(200);
          |                             ^
      123 |     const buffer = Buffer.from(await response.arrayBuffer());
      124 |     expect(buffer.length).toBeGreaterThan(0);
      125 |     expect(response.headers.get('x-logo-source')).toBe('google');

      at Object.toBe (__tests__/lib/logo.test.ts:122:29)

  ● Logo API › should handle successful logo fetches from Clearbit when Google fails

    expect(received).toBe(expected) // Object.is equality

    Expected: 200
    Received: 404

      161 |     const response = await GET(request);
      162 |
    > 163 |     expect(response.status).toBe(200);
          |                             ^
      164 |     const buffer = Buffer.from(await response.arrayBuffer());
      165 |     expect(buffer.length).toBeGreaterThan(0);
      166 |     expect(response.headers.get('x-logo-source')).toBe('clearbit');

      at Object.toBe (__tests__/lib/logo.test.ts:163:29)

  ● Logo API › should handle network timeouts

    expect(received).toBe(expected) // Object.is equality

    Expected: 404
    Received: 200

      176 |     const response = await GET(request);
      177 |
    > 178 |     expect(response.status).toBe(404);
          |                             ^
      179 |     expect(response.headers.get('x-logo-error')).toBe('Failed to fetch logo');
      180 |   }, 1000);
      181 |

      at Object.toBe (__tests__/lib/logo.test.ts:178:29)

  ● Logo API › should handle file system operations

    expect(jest.fn()).toHaveBeenCalled()

    Expected number of calls: >= 1
    Received number of calls:    0

      224 |     expect(response.headers.get('x-logo-source')).toBe('google');
      225 |     expect(response.headers.get('Content-Type')).toBe('image/png');
    > 226 |     expect(mockFs.writeFile).toHaveBeenCalled();
          |                              ^
      227 |   });
      228 | });
      229 |

      at Object.toHaveBeenCalled (__tests__/lib/logo.test.ts:226:30)

 PASS  __tests__/components/ui/navigation/navigation-link.test.tsx
 PASS  __tests__/components/ui/copy-button.test.tsx
 PASS  __tests__/components/ui/code-block.test.tsx
 PASS  __tests__/components/ui/logo-image.test.tsx
 PASS  __tests__/components/ui/terminal/terminal.test.tsx
 PASS  __tests__/components/ui/navigation/navigation.test.tsx
 PASS  __tests__/lib/cache.test.ts
--------------------------|---------|----------|---------|---------|---------------------------------------------------------------------------------------
File                      | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s
--------------------------|---------|----------|---------|---------|---------------------------------------------------------------------------------------
All files                 |   78.67 |    63.01 |   85.71 |   78.94 |
 app/api/logo             |   51.94 |    27.53 |   76.92 |   53.02 |
  route.ts                |   51.94 |    27.53 |   76.92 |   53.02 | ...72,188,195-198,208,214-264,277,283,289,295,301,322,335-340,350-364,401-414,438-440
 components/ui            |   92.68 |    88.09 |     100 |   93.15 |
  code-block.tsx          |    92.3 |    91.66 |     100 |      95 | 56
  copy-button.tsx         |     100 |      100 |     100 |     100 |
  logo-image.tsx          |   90.69 |     82.6 |     100 |   90.24 | 125,170,190,195
 components/ui/navigation |     100 |      100 |     100 |     100 |
  navigation-link.tsx     |     100 |      100 |     100 |     100 |
  navigation-links.ts     |     100 |      100 |     100 |     100 |
  navigation.tsx          |     100 |      100 |     100 |     100 |
  window-controls.tsx     |     100 |      100 |     100 |     100 |
 components/ui/terminal   |   68.85 |    48.48 |   60.71 |   69.91 |
  command-input.tsx       |     100 |      100 |     100 |     100 |
  commands.ts             |   84.37 |    72.72 |     100 |   83.87 | 37,79-83
  history.tsx             |     100 |      100 |     100 |     100 |
  sections.ts             |     100 |      100 |     100 |     100 |
  selection-view.tsx      |   34.61 |       10 |   44.44 |   34.78 | 23-39,60-61
  terminal.tsx            |     100 |      100 |     100 |     100 |
  use-terminal.ts         |   67.34 |    44.44 |   45.45 |   69.56 | 25,32,45,64,74-82,90
 lib                      |   89.78 |    76.99 |   91.66 |   90.52 |
  blog.ts                 |   72.22 |      100 |   66.66 |   73.33 | 38-41
  cache.ts                |     100 |      100 |     100 |     100 |
  constants.ts            |    86.2 |       75 |   71.42 |   88.88 | 79,91
  imageAnalysis.ts        |   92.45 |       75 |     100 |      96 | 212,280
  imageCompare.ts         |   80.76 |    61.76 |     100 |   80.76 | 56,168,247-248,261-270
  search.ts               |     100 |      100 |     100 |     100 |
  seo.ts                  |   75.86 |       75 |   77.77 |   77.77 | 213-225
  server-cache.ts         |   94.44 |      100 |   93.75 |   93.93 | 65,202
  utils.ts                |   97.67 |       90 |     100 |   97.29 | 97
 lib/test                 |     100 |      100 |     100 |     100 |
  setup.ts                |     100 |      100 |     100 |     100 |
--------------------------|---------|----------|---------|---------|---------------------------------------------------------------------------------------
Jest: "global" coverage threshold for statements (80%) not met: 78.67%
Jest: "global" coverage threshold for branches (80%) not met: 63.01%
Jest: "global" coverage threshold for lines (80%) not met: 78.94%

Test Suites: 1 failed, 16 passed, 17 total
Tests:       4 failed, 225 passed, 229 total
Snapshots:   0 total
Time:        2.036 s
Ran all test suites.